@model MissionAndRatingVM

@using System.Security.Claims;
@{
	var identity = User.Identity as ClaimsIdentity;
	var name = identity?.FindFirst(ClaimTypes.Name)?.Value;
	var surname = identity?.FindFirst(ClaimTypes.Surname)?.Value;
	var Email = identity?.FindFirst(ClaimTypes.Email)?.Value;
	var uid = identity?.FindFirst(ClaimTypes.Sid)?.Value;

}


<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
		  integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
	<link rel="stylesheet" href="~/css/MissonAndRating.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">


	<title>Related Mission & Rating</title>
	<style>
	
	</style>
</head>

<body>

	<section class="main">


		<!-- First navbar  -->
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<div id="navigation-bar">
					<button class="navbar-toggler border-0" href="#menubar" role="button" data-bs-toggle="offcanvas"
							aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
							id="navbar-toggler-btn">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="offcanvas offcanvas-start" tabindex="-1" id="menubar" aria-labelledby="offcanvasExampleLabel">
						<div class="offcanvas-header">
							<h5 class="offcanvas-title" id="offcanvasExampleLabel">Menu</h5>
							<button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
						</div>
						<div class="offcanvas-body">
							<li class="navbar-nav nav-item">
								<a class="nav-link" aria-current="page" asp-controller="Story" asp-action="StoryListingPage">Stories</a>
							</li>
							<li class="navbar-nav nav-item dropdown">
								<a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button"
								   data-bs-toggle="dropdown" aria-expanded="false">
									Privacy
								</a>
								<ul class="dropdown-menu" aria-labelledby="navbarScrollingDropdown">
									<li><a class="dropdown-item" href="#">Volunteering</a></li>
									<li><a class="dropdown-item" href="#">Sponsered</a></li>

								</ul>
							</li>
						</div>
					</div>
					</ul>
				</div>

				<div id="navigation-bar">
					<ul class="navbar-nav d-flex">
						@if (User.Identity.IsAuthenticated)
						{


							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button"
								   data-bs-toggle="dropdown" aria-expanded="false">
									@{
										var userImg = Model.UserData.Where(x => x.UserId == Convert.ToInt32(uid)).Select(x => x.Avatar).FirstOrDefault();
									}
									<img src="@Url.Content(userImg)" class="rounded-circle" height="35" width="35" alt="Profile pic"
										 loading="lazy" />
									@name @surname
								</a>
								<ul class="dropdown-menu" aria-labelledby="navbarScrollingDropdown">
									<li><a class="dropdown-item" asp-controller="User" asp-action="UserProfile">Add Profile</a></li>
									<li><a class="dropdown-item" asp-controller="User" asp-action="VolTimeSheet">Volunteering TimeSheet</a></li>
									@*	<li><a class="dropdown-item" href="#">Help Center</a></li>*@
									<li><a class="dropdown-item" asp-controller="Login" asp-action="Logout">LogOut</a></li>
								</ul>
							</li>
						}
						else
						{
							<ul class="navbar-nav d-flex">
								<li class="btn-info me-2 pe-1" style="border-radius: 4px;width: 70px;"><a class="dropdown-item btn p-1 text-center" asp-controller="Login" asp-action="Login">Login</a></li>
								<li class="btn-info me-2 pe-1" style="border-radius: 4px;width: 70px;"><a class="dropdown-item btn p-1 text-center" asp-controller="Registration" asp-action="Registration">Register</a></li>
							</ul>
						}
					</ul>
				</div>
			</div>
		</nav>








		<div class="filters-section d-flex align-items-center flex-wrap justify-content-start"
			 style="padding-left: 130px ;">
		</div>


	</section>



	<!--Third Row For Filter start-->
	<div class="filters-section d-flex align-items-center flex-wrap justify-content-start ps-2">
	</div>
	<!--Third Row For Filter end-->
	<!--Fourth row for mission slider and mission tab with volunteer start -->
	<div class="container mt-2">

		<!-- First Row for slider and details part start  -->
		<div class="row ">

			<!-- Column for left part  -->
			<div class="col-lg-6">

				<!-- Container for the image gallery carousel start -->
				<div class="container h-100">

					<!-- Full-width images with number text -->

					<div style="height: 80%;">
						<div class="mySlides h-100 ">
							<img src="~/Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png" style="width:100%" class="h-100">
						</div>

						<div class="mySlides h-100">
							<img src="~/Assets/img1.png" style="width:100%" class="h-100">
						</div>

						<div class="mySlides h-100">
							<img src="~/Assets/Grow-Trees-On-the-path-to-environment-sustainability-login.png" style="width:100%" class="h-100">
						</div>

						<div class="mySlides  h-100">
							<img src="~/Assets/img11.png" style="width:100%" class="h-100">
						</div>

						<div class="mySlides h-100">
							<img src="~/Assets/img11.png" style="width:100%" class="h-100">
						</div>

						<div class="mySlides h-100">
							<img src="~/Assets/image1.png" style="width:100%" class="h-100">
						</div>

						<!-- Next and previous buttons -->
						<a class="prev" onclick="plusSlides(-1)">&#10094;</a>
						<a class="next" onclick="plusSlides(1)">&#10095;</a>
					</div>

					<!-- Thumbnail images -->
					<div class="row mt-2 w-100 mx-auto my-auto" style="height: 15%;">
						<div class="column pe-0 ps-0">
							<img class="demo cursor h-100" src="~/Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-5.png"
		 style="width:100%" onclick="currentSlide(1)" alt="The Woods">
						</div>
						<div class="column pe-0">
							<img class="demo cursor h-100" src="~/Assets/img2.png" style="width:100%" onclick="currentSlide(2)"
		 alt="Cinque Terre">
						</div>
						<div class="column pe-0">
							<img class="demo cursor h-100" src="~/Assets/Grow-Trees-On-the-path-to-environment-sustainability-4.png"
		 style="width:100%" onclick="currentSlide(3)" alt="Mountains and fjords">
						</div>
						<div class="column pe-0">
							<img class="demo cursor h-100" src="~/Assets/img22.png" style="width:100%" onclick="currentSlide(4)"
		 alt="Northern Lights">
						</div>
						<div class="column pe-0">
							<img class="demo cursor h-100" src="~/Assets/img.png" style="width:100%" onclick="currentSlide(5)"
		 alt="Nature and sunrise">
						</div>
						<div class="column pe-0">
							<img class="demo cursor h-100" src="~/Assets/image.png" style="width:100%" onclick="currentSlide(6)"
		 alt="Snowy Mountains">
						</div>
					</div>
				</div>
				<!-- Container for the image gallery carousel end -->

			</div>

			<!-- Column for Right part  -->
			<div class="col-lg-6 mt-2">
				<!--Desrcription  start-->
				<div class="description">
					<p class="fs-3 mt-2 ps-2  font-weight-bold">
						@Model.MissionDetail.Title
					</p>
					<p class="mb-0 ps-2">
						@Model.MissionDetail.Description
					</p>
				</div>
				<!--Desrcription  end-->
				<!--no of seats section inside description start-->
				<div class="d-flex justify-content-between border-top border-bottom position-relative mt-3">
					<div class="d-flex align-items-center ps-5 mt-3 mb-2">
						<div>
							<img src="~/Assets/Seats-left.png" width="40px" height="40px" alt="">
						</div>
						<div class="ps-2">
							<h5 class="mb-0">@Model.MissionDetail.Availability</h5>
							<p class="mb-0">Seats left</p>
						</div>
					</div>
					<div class="pe-5">
						<div class="d-flex align-items-center mt-3 mb-2">
							<div>
								<img src="~/Assets/mission.png" alt="">
							</div>
							<div class="ps-3">
								<div class="progress mt-2">
									<div class="progress-bar" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0"
										 aria-valuemax="100"></div>
								</div>
								<div> <span class="text1">8000 achieved</div>
							</div>

						</div>
					</div>
					<div class="position-absolute" id="cardLable" style=" height:30px">

						@if (Model.MissionDetail.MissionType == "Goal")
						{

							<p class="mb-0 px-2">
								@Model.GoalMission.GoalValue
							</p>
						}
						else
						{
							<p class="mb-0 px-2">
								@Model.MissionDetail.StartDate.Value.ToShortDateString() to  @Model.MissionDetail.EndDate.Value.ToShortDateString()
							</p>
						}
						</p>
					</div>
				</div>

				<!--no of seats section inside description start-->
				<!--Button Section start-->
				<div class="mt-4 d-flex justify-content-evenly">

					@*@if (uid != null)
					{
					<a href="" class="btn  descBtn px-2" style="width:45%; border:2px solid #757575" onclick="AddtoFav(@Model.MissionDetail.MissionId)">
					@if (Model.FavoriteMissionList.Where(m => m.UserId.ToString() == uid && m.MissionId == Model.MissionDetail.MissionId).Count() == 1)
					{
					<i class="bi bi-heart-fill text-danger pe-2"></i>
					<small class="mb-0 h6">Remove From Favourite</small>
					}
					else
					{
					<i class="bi bi-heart pe-2"></i>
					<small class="mb-0 h6">Add to Favourite</small>
					}
					</a>
					}

					else
					{
					<a class="btn  descBtn px-2" style="width:45%; border:2px solid #757575" onclick="loginToPage()">
					<i class="bi bi-heart pe-2"></i>
					<small class="mb-0 h6">Add to Favourite</small>
					</a>


					}*@
					@if (uid != null)
					{
						var favMissionId = Model.MissionDetail.MissionId;
						var FavouriteMission = Model.FavoriteMissionList.Where(m => m.UserId == Convert.ToInt32(uid) && m.MissionId == favMissionId).FirstOrDefault();
						@if (FavouriteMission != null)
						{
							<button class=" favorite added favBtn" style=" border:2px solid #757575; border-radius: 50px;" onclick="addFavourite(@Model.MissionDetail.MissionId);">
								<img src="~/Assets/favourite.png" alt="" class="ms-2 " style="width: 30px;height: 30px;">
								Remove Favourite
							</button>
						}
						else
						{

							<button class=" favorite favBtn" style=" border:2px solid #757575; border-radius: 50px;" onclick="addFavourite(@Model.MissionDetail.MissionId);">
								<img src="~/Assets/heart1.png" alt="" class="ms-2 " style="width: 30px; height: 30px;"> Add to Favourite
							</button>
						}
					}
					else
					{
						<button class=" favorite favBtn" style=" border:2px solid #757575; border-radius: 50px;" onclick="notloggedin();">
							<img src="~/Assets/heart1.png" alt="" class="ms-2 " style="width: 30px; height: 30px;"> Add to Favourite
						</button>
					}

					@*<a href="" class="btn  descBtn px-2" style="width:45%; border:2px solid #757575">	<img src="~/Assets/add1.png" alt=""> Recommended to
					Co-Worker
					</a>*@
					@if (uid != null)
					{
						<div style=" border:2px solid #757575; border-radius: 50px;">
							<button type="button" class="btn btn-Secondary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="getUser();" style="border: 1px solid; border-radius: 50px;">
								<img src="~/Assets/add1.png" /> Recommended to co-worker
							</button>

							<!-- Modal -->
							<div class="modal fade " id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										@*<div id="model-content">*@

											<div class="modal-header">
												<h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
												<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="getUser();"></button>
											</div>
											<div class="modal-body" style="overflow:scroll; height:400px;">
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
												<button type="button" class="btn btn-success" id="sendmail">Send Mail</button>
											</div>
										@*</div>*@
										@*<div class="d-none w-100 text-center" id="volPageLoader">
											<div class="spinner-border text-warning" role="status">
											</div>
											<p>Sending Mail...</p>
										</div>*@
									</div>
								</div>
							</div>
							@*<ul class="dropdown-menu scrollable-menu ps-2" style="width:100%">
						@foreach (var userData in Model.UserForRecommendation)
						{
						<li class="form-check">
						<input class="form-check-input " type="checkbox" value=""
						>
						<label class="form-check-label" for="flexCheckDefault">
						@userData.FirstName @userData.LastName
						</label>
						</li>
						}
						</ul>*@
						</div>
					}
					else
					{
						<button type="button" class="btn btn-Secondary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" style="border: 1px solid; border-radius: 50px;" onclick="notloggedin();">
							<img src="~/Assets/add1.png" /> Recommended to co-worker
						</button>
					}
				</div>
				<!--Button Section end-->
				<!--star section start-->
				<div class=" border-top mt-4 position-relative">


					<div class=" d-flex position-absolute" id="starPosition">

						@*for(int i = 0; i < Model.missionRate; i++)
						{
						<span>
						<img src="~/Assets/selected-star.png" class="star" alt="">
						</span>
						}
						@for(int i=Model.missionRate; i < 5; i++)
						{
						<span>
						<img src="~/Assets/star.png" class="star" alt="">
						</span>
						}
						*@

						<div class="" id="ratings" style="background-color:white" onmouseout="CRateSelected()">
							<img class="rating-star" id="span1" onmouseout="CRateOut(1)" onmouseover='CRateOver(1)' onclick='CRateClick(1)' src="~/Assets/star-empty.png" alt="" style="width:28px">
							<img class="rating-star" id="span2" onmouseout="CRateOut(2)" onmouseover="CRateOver(2)" onclick="CRateClick(2)" src="~/Assets/star-empty.png" alt="" style="width:28px">
							<img class="rating-star" id="span3" onmouseout="CRateOut(3)" onmouseover="CRateOver(3)" onclick="CRateClick(3)" src="~/Assets/star-empty.png" alt="" style="width:28px">
							<img class="rating-star" id="span4" onmouseout="CRateOut(4)" onmouseover="CRateOver(4)" onclick="CRateClick(4)" src="~/Assets/star-empty.png" alt="" style="width:28px">
							<img class="rating-star" id="span5" onmouseout="CRateOut(5)" onmouseover="CRateOver(5)" onclick="CRateClick(5)" src="~/Assets/star-empty.png" alt="" style="width:28px">

						</div>

						<div>
							<input type="hidden" id="lblRating" value=""/>
						</div>




					</div>
				</div>
				<!--star section end-->

				<!--City,theme,date,organization section is start-->
				<div class="container-fluid">
					<div class="row d-flex mt-5 mx-auto">
						<div class="col-md-3 col-sm-6 border ps-2 pt-2 samebox">
							<img src="~/Assets/pin1.png" alt="">
							<p class="mb-0 mt-4">City</p>
							<p class="mb-0">@Model.City.Name</p>
						</div>
						<div class="col-md-3 col-sm-6 border ps-2 pt-2 samebox">
							<img src="~/Assets/web.png" alt="">
							<p class="mb-0 mt-4">Theme</p>
							<p class="mb-0">@Model.MissionTheme.Title</p>
						</div>
						<div class="col-md-3 col-sm-6 border ps-2 pt-2 samebox1">
							<img src="~/Assets/calender.png" alt="">
							<p class="mt-4 mb-0">Date</p>
							<p class="mb-0">@Model.MissionDetail.EndDate.Value.ToShortDateString()</p>
						</div>
						<div class="col-md-3 col-sm-6 border  ps-2 pt-2 samebox1">
							<img src="~/Assets/organization.png" alt="">
							<p class="mb-0 mt-4">Organization</p>
							<p class="mb-0">@Model.MissionDetail.OrganizationName</p>
						</div>
					</div>
				</div>

				<!--City,theme,date,organization section is end-->
				@if (User.Identity.IsAuthenticated)
				{
					<div class="text-center mt-3 mb-3">
						@{
							var currentlySelectMission = Model.MissionDetail.MissionId;
							var alreadyAppliedUser = @Model.missionApplications.Where(x => x.UserId == Convert.ToInt32(uid) && x.MissionId == currentlySelectMission).FirstOrDefault();
							if (alreadyAppliedUser == null)
							{
								<a href="" class="btn  py-2 px-3 " id="applyBtn" style="border: 2px solid #F88634;
													color: #F88634;" onclick="applyMission()">Apply Now <img src="~/Assets/right-arrow.png" class="ps-3" alt=""></a>
							}

							else
							{
								<a href="" class="btn  py-2 px-3 " id="applyBtn" style="border: 2px solid #F88634;
												color: #F88634;" onclick="applyMission()" disabled>Already Applied <img src="~/Assets/right-arrow.png" class="ps-3" alt=""></a>
							}

						}


					</div>
				}



			</div>
			<!--no of seats section inside description end-->

		</div>
		<!-- First Row for slider and details part end  -->
		<!--second row for tabs and information about volunteers start-->
		<div class="row mt-3">

			<!-- left part for tabs  -->
			<div class="col-lg-8 col-sm-12">
				<!-- Tabs navs -->
				<ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
					<li class="nav-item" role="presentation">
						<a class="nav-link active" id="ex1-tab-1" data-bs-toggle="tab" href="#ex1-tabs-1" role="tab"
						   aria-controls="ex1-tabs-1" aria-selected="true">Mission</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="ex1-tab-2" data-bs-toggle="tab" href="#ex1-tabs-2" role="tab"
						   aria-controls="ex1-tabs-2" aria-selected="false">Organization</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="ex1-tab-3" data-bs-toggle="tab" href="#ex1-tabs-3" role="tab"
						   aria-controls="ex1-tabs-3" aria-selected="false">Comments</a>
					</li>
				</ul>
				<!-- Tabs navs -->
				<!-- Tabs content -->
				<div class="tab-content" id="ex1-content">


					<!--First Tab Start-->
					<div class="tab-pane fade show active ms-4" id="ex1-tabs-1" role="tabpanel" aria-labelledby="ex1-tab-1">
						<h3>Introduction</h3>
						<p>
							@Model.MissionDetail.Description
						</p>

						<h3>Challenge</h3>
						<p>
							@Model.MissionDetail.Challange
						</p>

						<h3>Documents</h3>
						<div class="d-flex flex-wrap justify-content-evenly ">

							@foreach (var documents in Model.MissionDetail.MissionDocuments)
							{
								if (documents.MissionId == Model.MissionDetail.MissionId)
								{
									if (documents.DocumentType == "pdf")
									{
										<div class="d-flex justify-content-center mt-2">
											<a class="btn btn-outline-dark rounded-pill py-2" href="@documents.DocumentPath" target="_blank" download="@documents.DocumentPath">
												<img src="~/Assets/pdf.png" alt="like" /> @documents.DocumentName
											</a>
										</div>
									}
									else if (documents.DocumentType == "image")
									{
										<div class="d-flex justify-content-center mt-2">
											<a class="btn btn-outline-dark rounded-pill py-2" href="@documents.DocumentPath" target="_blank" download="@documents.DocumentPath">
												<img src="~/Assets/pdf.png" alt="like" /> @documents.DocumentName
											</a>
										</div>
									}
									else if (documents.DocumentType == "docs")
									{
										<div class="d-flex justify-content-center mt-2">
											<a class="btn btn-outline-dark rounded-pill py-2" href="@documents.DocumentPath" target="_blank" download="@documents.DocumentPath">
												<img src="~/Assets/xlsx.png" alt="like" /> @documents.DocumentName
											</a>
										</div>
									}
								}
							}


						</div>
					</div>
					<!--First Tab end-->
					<!--Second Tab Start-->
					<div class="tab-pane fade ms-4" id="ex1-tabs-2" role="tabpanel" aria-labelledby="ex1-tab-2">
						<p>
							@Model.MissionDetail.OrganizationName
						</p>
					</div>
					<!--Second Tab End-->
					<!--Third Tab Start-->
					<div class="tab-pane fade ms-2 pb-2 " style="background-color: rgb(208, 236, 241);" id="ex1-tabs-3"
						 role="tabpanel" aria-labelledby="ex1-tab-3">
						<div class="form-group ps-2 pt-2 pe-2">
							<textarea class="form-control " id="comment" rows="3"
									  placeholder="Enter your comments..."></textarea>
						</div>
						@*<input type="hidden" value="@Model.MissionDetail.MissionId" id="missionId" />*@
							@if (User.Identity.IsAuthenticated)
									{
							<button class="btn btn-outline-warning ms-2 mt-2" id="commentButton">Post Comment</button>
						}
						else
						{
							<button class="btn btn-outline-warning ms-2 mt-2" onclick="notloggedin();">Post Comment</button>
						}
						<div class="Scroll" id="LoadingComment">

							@{
								var mission_id = Model.MissionDetail.MissionId;

								foreach (var commentByUser in Model.comments.Where(x => x.MissionId == mission_id))
								{
									<div class="d-flex mt-2 ms-2 bg-light rounded-2 me-2">
										<div class="my-auto">


											@{
												var commentUserImage = Model.UserForRecommendation.Where(x => x.UserId == commentByUser.UserId).Select(x => x.Avatar).FirstOrDefault();
												<img src="@Url.Content(@commentUserImage)" width="50px" height="50px" class="volImg ms-2" alt="">
											}
										</div>


										<div class="ps-3">
											@{
												var user_id = commentByUser.UserId;
												var fName = Model.UserForRecommendation.Where(x => x.UserId == user_id).Select(x => x.FirstName).FirstOrDefault();
												var lName = Model.UserForRecommendation.Where(x => x.UserId == user_id).Select(x => x.LastName).FirstOrDefault();
											}
											<p class="mb-0">@fName @lName</p>
											<small style="font-size: 12px;">@commentByUser.CreatedAt</small>
											<p>@commentByUser.ApprovalStatus</p>
										</div>
									</div>

								}
							}

						</div>
					</div>
					<!--Third Tab end-->

				</div>
				<!-- Tabs content -->
			</div>

			<!-- Right part for volunteer  -->
			<div class="col-lg-4 col-sm-12">

				<!--Div  for volunteers skills, day and rating start-->
				<div class="me-5 border mb-4">
					<!-- Tabs navs -->
					<ul class="nav nav-tabs mb-3 " id="ex1" role="tablist">
						<li class="nav-item" role="presentation">
							<a class="nav-link active" id="ex1-tab-1" data-mdb-toggle="tab" href="#ex1-tabs-1" role="tab"
							   aria-controls="ex1-tabs-1" aria-selected="true">Information</a>
						</li>
					</ul>
					<!-- Tabs navs -->
					<!-- Tabs content start-->
					<div class="tab-content " id="ex1-content">
						<div class="tab-pane fade show active ps-2" id="ex1-tabs-1" role="tabpanel" aria-labelledby="ex1-tab-1">
							<div class="d-flex border-bottom">
								<p>Skills </p>
								<p class="ms-5">
									@foreach (var skill in Model.MissionSkills)
									{
										<span>@skill.Skill.SkillName</span>
									}
								</p>
							</div>
							<div class="d-flex border-bottom">
								<p class="mt-2">Days </p>
								<p class="ms-5 mt-2">Weekend Only </p>
							</div>
							<div class="d-flex  border-bottom">
								<p class="mb-1 mt-2">Rating </p>
								<div class="d-flex ms-4 ps-2 mt-2">

									@for (int i = 0; i < Model.missionRate; i++)
									{
										<span>
											<img src="~/Assets/selected-star.png" class="star" alt="">
										</span>
									}
									@for (int i = Model.missionRate; i < 5; i++)
									{
										<span>
											<img src="~/Assets/star.png" class="star" alt="">
										</span>
									}
									<p>(by @Model.RatedVolunteers volunteers)</p>
								</div>
							</div>
						</div>
					</div>
					<!-- Tabs content end -->

				</div>
				<!--div code for volunteers skills, days and rating end-->
				<!--Below code for recent volunteers start-->

				<div class="me-5 border mb-4">
					<!-- Tabs navs -->
					<ul class="nav nav-tabs mb-3 " id="ex1" role="tablist">
						<li class="nav-item" role="presentation">
							<a class="nav-link active" id="ex1-tab-1" data-mdb-toggle="tab" href="#ex1-tabs-1" role="tab"
							   aria-controls="ex1-tabs-1" aria-selected="true">Recent Volunteers</a>
						</li>
					</ul>
					<!-- Tabs navs -->
					<!-- Tabs content -->
					<div class="tab-content " id="ex1-content">
						<div class="tab-pane fade show active ps-2" id="ex1-tabs-1" role="tabpanel" aria-labelledby="ex1-tab-1">
							<div class="d-flex justify-content-evenly flex-wrap">
								@{
									var userApplied1 = @Model.MissionDetail.MissionId;

									foreach (var volunteer in Model.missionApplications.Where(x => x.MissionId == userApplied1))
									{
										<div class="text-center">
											@*
									@{
									var commentUserImage = Model.UserForRecommendation.Where(x => x.UserId ==commentByUser.UserId).Select(x => x.Avatar).FirstOrDefault();
									<img src="@Url.Content(@commentUserImage)" width="50px" height="50px" class="volImg ms-2" alt="">
									}*@
											@{

												var volunteerImage = Model.UserForRecommendation.Where(x => x.UserId == volunteer.UserId).Select(x => x.Avatar).FirstOrDefault();
												<img src="@Url.Content(@volunteerImage)" class="volImg" width="70px" height="70px" alt="">
											}

											@{
												var user_id = volunteer.UserId;
												var fName = Model.UserForRecommendation.Where(x => x.UserId == user_id).Select(x => x.FirstName).FirstOrDefault();
												var lName = Model.UserForRecommendation.Where(x => x.UserId == user_id).Select(x => x.LastName).FirstOrDefault();
											}
											<p style="font-size: 13px;">
												@fName @lName
											</p>
										</div>
									}

								}


							</div>

							<nav aria-label="Page navigation example">
								<ul class="pagination">
									<li class="page-item ms-2">
										<a class="page-link" href="#" aria-label="Previous">
											<span aria-hidden="true">&laquo;</span>
										</a>
									</li>
									<li class="page-item px-3">
										<a class="page-link ms-2" href="#">
											1-9 of 15 Recent
											Volunteeres
										</a>
									</li>
									<li class="page-item ps-1">
										<a class="page-link  ms-2" href="#" aria-label="Next">
											<span aria-hidden="true">&raquo;</span>
										</a>
									</li>
								</ul>
							</nav>
						</div>
					</div>
					<!-- Tabs content -->
				</div>
				<!--abov code for recent volunteers end-->
			</div>

		</div>
		<!--second row for tabs and information about volunteers end-->
	</div>


	<!--Fourth row all about description and photos about mission start -->
	<!--fifth row all about related card start -->

	<div class="container">
		<div class="row">
			<div class="fs-3 text-center mb-4 mt-4" style=" font-family: NotoSans-Light,; color: #414141;">
				Related Missions
			</div>


			<!-- Card Items  -->
			<div class="container grid-container mt-2">
				@{
					var count = Model.RelatedMissions.Count();
					if (count > 0)
					{
						<div class="row">

							@foreach (var item in Model.RelatedMissions)
							{
								if (item.MissionType == "Time")
								{
									<!-- Time based mission  -->
									<div class="col-12 col-md-6 col-lg-4 card ">
										@*<div class="card">*@

										<div class="">
											<!-- Time based mission  Upper Body  -->
											<div class="position-relative">
												<img src="~/Assets/Nourish-the-Children-in--African-country.png" class="card-img-top" alt="...">

												@if (User.Identity.IsAuthenticated)
												{
													var currentDate = DateTime.Now;
													if (currentDate > item.EndDate)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: red; color:white;">
															Closed
														</div>
													}
													else if (Model.missionApplications.Where(x => x.MissionId == item.MissionId && x.UserId == long.Parse(uid)).Count() == 1)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: green; color:white;">
															Applied
														</div>
													}
													else if (currentDate < item.EndDate)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: #FF6600; color:white;">
															Ongoing Mission
														</div>
													}
												}
												<div class="position-absolute c1-location px-2 py-1">
													<img src="~/Assets/pin.png" alt="">
													@item.City.Name
												</div>
												<div class="position-absolute c1-heart px-2 py-1">
													<img src="~/Assets/heart.png" alt="">
												</div>
												<div class="position-absolute c1-person px-2 py-1">
													<img src="~/Assets/user.png" alt="">
												</div>
												<div class="text-center position-absolute" id="mission-theme" style=" left: 50%;
														transform: translateX(-50%);">
													<p class="ps-1 pe-1 mb-0" style="border-radius: 20px; background-color: white;">
														@item.Theme.Title
													</p>
												</div>
											</div>


											<!-- Time based mission  Body-->
											<div class="card-body">
												<h5 class="card-title">@item.Title</h5>
												<p class="card-text">
													@item.ShortDescription
												</p>
												<div class="d-flex justify-content-between mb-3">

													<div class="mt-1">
														<p class="rateData ms-3 mb-0">@item.OrganizationName</p>
													</div>

													<div class="d-flex  align-items-center">
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/star.png" class="star" alt="">
														<img src="~/Assets/star.png" class="star" alt="">
													</div>
												</div>
												<div class="d-flex justify-content-between position-relative border-top border-bottom py-4">
													<div class="text-center position-absolute" id="mission-deadline" style=" top: -15px;left: 50%;transform: translateX(-50%);">
														<p style="border: 1px solid gray;border-radius: 20px; font-size:12px" class="ps-1 pe-1">
															@item.StartDate.Value.ToShortDateString() to @item.EndDate.Value.ToShortDateString()
														</p>
													</div>
													<div class="d-flex align-items-center">
														<div class=" mt-1 me-2 mx-auto">
															<img src="~/Assets/Seats-left.png" width="25px" height="25px" alt="">
														</div>
														<div class=" px-0">
															<h6 class="mb-0 mt-1">10</h6>
															<p class="mb-0">Seats left</p>
														</div>
													</div>
													@*
													<div class="d-flex align-items-center " id="skillList" style="display:none">
														<div class="mt-1 pe-0 me-2">
															<img src="~/Assets/Seats-left.png" alt="" width="25px" height="25px">
														</div>
														<div class="px-0 ">
															<h6 class="mb-0 mt-1">Skills</h6>
															<p class="mb-0">
																@foreach (var skill in Model.MissionSkills)
																{
																	<span>@skill.Skill.SkillName</span>
																}
															</p>
														</div>
													</div>
													*@
													<div class="d-flex align-items-center">
														<div class=" mt-1 me-2 mx-auto">
															<img src="~/Assets/deadline.png" width="25px" height="25px" alt="">
														</div>
														<div class=" px-0">
															<h6 class="mb-0 mt-1">09/01/2019</h6>
															<p class="mb-0">Deadline</p>
														</div>
													</div>
												</div>

												<!-- Time based mission button-->
												<div class="card-footer text-center">

													<a type="submit" asp-controller="Home" asp-action="MissionAndRating" asp-route-id="@item.MissionId" class="btn  rounded-pill" style="border: 2px solid #F88634;
													  	color: #F88634;">
														Explore Now <img src="~/Assets/right-arrow.png" alt="">
													</a>

												</div>
											</div>
											@*</div>*@
										</div>
									</div>
								}
								else if (item.MissionType == "Goal")
								{
									<!-- Goal based Mission -->
									<div class="col-12 col-md-6 col-lg-4 card">
										@*<div class="card">*@
										<div class="">
											<!-- Goal based Mission Upper Body  -->
											<div class="position-relative">
												<img src="~/Assets/Animal-welfare-&-save-birds-campaign.png" class="card-img-top" alt="...">
												@if (User.Identity.IsAuthenticated)
												{
													var currentDate = DateTime.Now;
													if (currentDate > item.EndDate)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: red; color:white;">
															Closed
														</div>
													}
													else if (Model.missionApplications.Where(x => x.MissionId == item.MissionId && x.UserId == long.Parse(uid)).Count() == 1)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: green; color:white;">
															Applied
														</div>
													}
													else if (currentDate < item.EndDate)
													{
														<div class="position-absolute py-1 px-4 rounded-end" style="top: 1rem;background-color: #FF6600; color:white;">
															Ongoing Mission
														</div>
													}
												}
												<div class="position-absolute c1-location px-2 py-1">
													<img src="~/Assets/pin.png" alt="">
													@item.City.Name
												</div>
												<div class="position-absolute c1-heart px-2 py-1">
													<img src="~/Assets/heart.png" alt="">
												</div>
												<div class="position-absolute c1-person px-2 py-1">
													<img src="~/Assets/user.png" alt="">
												</div>
												<div class="text-center position-absolute" id="mission-theme" style=" left: 50%;
													transform: translateX(-50%); bottom: -27px;">
													<p class="ps-1 pe-1" style="border-radius: 20px; background-color: white;">
														@item.Theme.Title
													</p>
												</div>
											</div>


											<!--  Goal based Mission Body-->
											<div class="card-body">
												<h5 class="card-title">@item.Title</h5>
												<p class="card-text">
													@item.ShortDescription
												</p>
												<div class="d-flex justify-content-between mb-3">

													<div class="mt-1">
														<p class="rateData ms-3 mb-0">@item.OrganizationName</p>
													</div>

													<div class="d-flex  align-items-center">
													
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/selected-star.png" class="star" alt="">
														<img src="~/Assets/star.png" class="star" alt="">
														<img src="~/Assets/star.png" class="star" alt="">
														

													</div>
												</div>
												<div class="d-flex justify-content-between position-relative border-top border-bottom py-4">
													<div class="text-center position-absolute" id="mission-deadline" style=" top: -15px;
											left: 50%;
											transform: translateX(-50%);">
														<p style="border: 1px solid gray;border-radius: 20px; font-size:15px" class="ps-1 pe-1">
															Ongoing Oppurtunity
														</p>
													</div>
													<div class="d-flex align-items-center">
														<div class=" mt-1 me-2 mx-auto">
															<img src="~/Assets/Seats-left.png" width="25px" height="25px" alt="">
														</div>
														<div class=" px-0">
															<h6 class="mb-0 mt-1">@item.Availability</h6>
															<p class="mb-0">Seats left</p>
														</div>
													</div>
													@*
													<div class="d-flex align-items-center " id="skillList" style="display:none">
														<div class="mt-1 pe-0 me-2">
															<img src="~/Assets/Seats-left.png" alt="" width="25px" height="25px">
														</div>
														<div class="px-0 ">
															<h6 class="mb-0 mt-1">Skills</h6>
															<p class="mb-0">
																@foreach (var skill in Model.MissionSkills)
																{
																	<span>@skill.Skill.SkillName</span>
																}
															</p>
														</div>
													</div>
													*@
													<div class="d-flex align-items-center">
														<div class=" mt-1 me-2 mx-auto">
															<img src="~/Assets/achieved.png" width="25px" height="25px" alt="">
														</div>
														<div class=" px-0">
															<div class="progress">
																<div class="progress-bar bg-warning" role="progressbar" style="width: 75%" aria-valuenow="75"
																	 aria-valuemin="0" aria-valuemax="100"></div>
															</div>
															<p class="mb-0">8000 achieved</p>
														</div>
													</div>
												</div>


												<!--  Goal based Mission Button-->
												<div class="card-footer text-center">


													<a type="submit" asp-controller="Home" asp-action="MissionAndRating" asp-route-id="@item.MissionId" class="btn  rounded-pill" style="border: 2px solid #F88634;
													  	color: #F88634;">
														Explore Now <img src="~/Assets/right-arrow.png" alt="">
													</a>

												</div>
											</div>
											@*</div>*@

										</div>
									</div>
								}
							}
						</div>
					}
					else
					{
						<div class="text-danger">
							<h3>No Related Missions</h3>
						</div>
					}
				}

				<!--fifth row all about related card end -->

			</div>
		</div>
	</div>



	-

	<!--footer satrt-->
	<div class="copyright mt-5 bg-dark " style=" position: fixed; bottom: 0px; width: 100%;">
		<div class="container">
			<div class="row">
				<div class="col-md-6">
					<div class="copyright-menu">
						<ul>
							<li>
								<a href="#" style="color:#acacac">Privacy Policy</a>
							</li>
							<li>
								<a asp-controller="Login" asp-action="PolicyPage" style="color:#acacac">Cookie Policy</a>
							</li>
							<li>
								<a href="" style="color:#acacac">Contact Us</a>
							</li>
							<li>
								<a href="#" style="color:#acacac">Terms of Use</a>
							</li>

						</ul>
					</div>
				</div>
				<div class="col-md-6 rights">
					<span style="color:#acacac"> © 2019 Optimy.com. All Right Reserved</span>
				</div>
			</div>
		</div>
	</div>
	<!--footer end-->


	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
			integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
			crossorigin="anonymous"></script>


	<a href="~/lib/jquery/dist/jquery.min.map"></a>
	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/lib/jquery/dist/jquery.js"></script>

	<script src="~/js/MissonAndRating.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script type="text/javascript">

		// Rating star
		@*$(".ratingStar").hover(function(){
			$(".ratingStar").addClass("fa-regular").removeClass("fa-solid")

			$(this).addClass("fa-solid").removeClass("fa-regular")
			$(this).prevAll(".ratingStar").addClass("fa-solid").removeClass("fa-regular")
			});
			*@


			//  Run on onmouseout() event
			function CRateOut(rating) {
				for (var i = 1; i <= rating; i++) {
					$("#span" + i).attr('src', "/Assets/star-empty.png");
				}
			}


		//  Run on onmouseover() event
		function CRateOver(rating) {
			for (var i = 1; i <= rating; i++) {
				$("#span" + i).attr('src', "/Assets/selected-star.png");
			}
		}


		//  Run on onmouseclick() event
		function CRateClick(rating) {
			$("#lblRating").val(rating);

			for (var i = 1; i < rating + 1; i++) {
				$("#span" + i).attr('src', "/Assets/selected-star.png");
			}
			for (var i = rating + 1; i <= 5; i++) {
				$("#span" + i).attr('src', "/Assets/star-empty.png");
			}
			sendrate(rating);
		}


		//  Run on onmouseout() event
		function CRateSelected() {
			var rating = $("#lblRating").val();
			for (var i = 1; i <= rating; i++) {
				$("#span" + i).attr('src', "/Assets/selected-star.png");
			}
		}



		// Sendrateing to Controller
		function sendrate(rating) {
			$.ajax({
				url: "/Home/UpdateAndRate",
				type: "POST",
				data: {
					missionid: @Model.MissionDetail.MissionId,
					rating: rating,
					Email: "@Email"
				},
				success: function (result) {
					console.log(rating);
					console.log("Rating is updated succesfully");
				}
			});
		}

		$(document).ready(function(){


		 $("#lblRating").val(@Model.userRate);
			CRateSelected();

		})


		// Function for Add to favourite button
		@*
			function AddtoFav(mId) {
			$.ajax({
			type: "POST",
			url: "/Home/favouriteMission",
			data: {
			'id': mId
			},
			success: function (result) {
			console.log(rating);
			console.log("rating is updated succesfully");
			location.href = "Home/MissionAndRating/" + result;

			},
			error: function () {
			alert("Error from addFav");
			}
			});
			}
			*@

			

		// Comments

		var commentBtn = document.querySelector('#commentButton');

		$(commentBtn).click(postComment);

		function postComment() {
			var commentdetail = document.getElementById('comment').value;
			// alert(commentdetail);
			$.ajax({
				type: "POST",
				url: "/Home/CommentOnMission",
				data: {
					mId: @Model.MissionDetail.MissionId,
					commentText1: commentdetail
				},
				success: function (result) {
					// alert("comment successfully submited");
					console.log("comment succesfully added");
					$('#LoadingComment').html($(result).find('#LoadingComment').html());

					$('#comment').val('');
				},
				error: function () {
					alert("Error from commentOnMission");
				}
			});
		}

		function loginToPage() {
			alert("Login First");
			console.log("Login First");
		}


		// Function for sending mail to user
		function senduser() {
			var selecteduserid = [];
			$('.modal-body input[type="checkbox"]:checked').each(function () {
				selecteduserid.push($(this).attr("id"));
			});
			//console.log(selecteduserid);
			//$('#volPageLoader').removeClass('d-none');
			//$('#model-content').addClass('d-none');
			if (selecteduserid.length != 0) {
				$.ajax({
					type: "POST",
					url: '/Home/SentUserMail',
					data: {
						ids: selecteduserid,
						missionid: @Model.MissionDetail.MissionId,
					},
					traditional: true,
					beforeSend: function () {
						swal.fire({
							html: '<h5>Loading...</h5><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>',
							showConfirmButton: false,
							onRender: function () {
								// there will only ever be one sweet alert open.
								$('.swal2-content').prepend(sweet_loader);
							}
						});
					},
					success: function (response) {
						//swal("Thank you for your order", data, "success");
						//$('#volPageLoader').addClass('d-none');
						//$('#model-content').removeClass('d-none');

						setTimeout(function () {
							swal.fire({
								icon: 'success',
								html: '<h5>Success!</h5>'
							});
						}, 500);
					}
				});
			}
			else {
				//alert('Select at least one user!');
				$('#volPageLoader').addClass('d-none');
				$('#model-content').removeClass('d-none');
			}
		}



		// Get Users-List for Recommendation
		function getUser() {
			var div = $('.modal-body');
			//alert("inside getusers");
			$.ajax({
				type: "GET",
				url: "/Home/GetUsers ",
				data: {},
				dataType: "json",
				success: function (result) {
					div.empty();
					$.each(result, function (i, data) {
						div.append('<div class="form-check ms-3 mb-2"><input class="form-check-input checkbox mt-3" type="checkbox" value="' + data.firstName + " " + data.lastName + '" id=' + data.userId + '><img src="' + data.avatar + ' " class="user-image mx-3"/><label class="form-check-label" for=' + data.userId + '>' + data.firstName + " " + data.lastName + '</label></div>')
					})

				}
			});

			$('#sendmail').click(function () {
				senduser();
			})
		}

		// Add to favourite function
		function addFavourite(missionId) {

			$.ajax({
				url: "/Home/doFavouriteMission",
				type: "POST",
				data: {
					mId: missionId
				},
				success: function (result) {
					location.reload();
					console.log(result);
					//$('.xyz').html($(result).find('.xyz').html());
				}
			})


		}

		// Apply for Mission Button
		function applyMission() {
			// alert('Inside function');
			$.ajax({
				type: 'POST',
				url: '/Home/appliedForMission',
				data: {
					mId: @Model.MissionDetail.MissionId,

				},
				success: function (response) {
					location.reload();
				},
				error: function () {
					alert("Error occured during applied");
				}
			});
		}
														/*function recommendattion(mId){
		var userids = [];
		$('.modal-body input:checked').each(function () {
		userids.push($(this).attr("id"));
		})
		console.log(userids);
		$.ajax({
		type: "POST",
		url: "/Home/RecommendateUser",
		data: {
		userIds:userids,
		missionid: mId,
		},
		success: function (result) {
		toastr.success('Invite Link Sent');
		}
		})
		}*/
	</script>

</body>

</html>